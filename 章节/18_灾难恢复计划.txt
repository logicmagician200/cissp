00，简介
        灾难恢复就是从紧急状态恢复服务的过程。


01，UPS
        不间断电源(Uninterruptible Power Supply)

01，保障系统的容错能力
    设备：
        冗余系统--主备冗余
        集群
        网格计算：不适用需要保密的信息
    电力：
        UPS
        柴油发电机
    驱动器和数据存储：
        1，SAN Storage Area Network 存储区域网络
                1，在专用网络中包含专用数据块级的存储
                2，具有需要存储设备：磁带库，光驱、磁盘阵列等
                3，使用如 iSCSI 协议使得存储展现给操作系统如本地磁盘一样
                4，大量磁盘使用专用控制器或 IP 网络来连接各种系统

        2，NAS Network-Attached Storage 网络接入存储
                1，使用文件级存储来代替数据块级。
                2，设计用于简单存储和服务文件，如 FTP 服务器文件共享实现网络驱动器。
                3，NAS 同样可以为跨网络的多系统提供存储服务
        
        3，直接访问和顺序访问
                直接访问可以直接到达存储位置。
                顺序访问时，需要穿越当前位置才能到达存储位置。

        4，RAIT 冗余独立磁带驱动器
                使用磁带驱动器，而非磁盘驱动器。
                存储大量数据时，磁带的成本低。
                相比于磁盘，磁带的速度慢。

    备份和恢复系统：



    人员编制的弹性：



02，RAID 磁盘阵列

    1，RAID 0
            在不使用奇偶校验的情况下将数据以条带化的方式写入多个磁盘。
            提升了读写速度，所有磁盘可以并行读写。
            不提供冗余。
    
    2，RAID 1
            将一个磁盘的数据复制到另外一个磁盘，以创建两个相同的驱动。
            数据镜像。
            冗余。

    3，RAID 2
            更多是理论上的，较少在实践中使用。

            汉明纠错码。

    4，RAID 3 and 4
            RAID 3 是字节级别的校验。
            RAID 4 是块级别的校验。

            需要 3 个或更多的驱动器才能实现。

            条带化。

            奇偶校验信息写在一个磁盘上，可能成为瓶颈，通常比其他驱动器更早出现故障。

    5，RAID 5
            和 RAID 4 相似。
            奇偶校验信息分部到每一个磁盘上

            条带化。
            较为常用
    
    6，RAID 6
            扩展了 RAID 5 的功能

            计算两组奇偶校验信息

            RAID 6 性能稍差

    7，RAID 10 and RAID01
            一般来说，无论是在速度还是在冗余方面，RAID 1+0 都不认为在所有方面都优于 RAID 0+1。

            在 RAID 0+1 中，第一组磁盘将所有可以驱动器（RAID 0 部分）上的数据条带化，这些驱动器再被镜像到另一组磁盘（RAID 1 部分）


03，数据备份
    1，差异备份
        每周一次全备份。
        每天全备份与周全备份的差异。
    2，增量备份
        每周一次全备份。
        其余每天备用与上一次备份的差异。

    3，全量备份

备份磁带个数
        至少需要 3 个：
                1，原站点：恢复单个故障系统
                2，近站点：主站点受到普遍故障，且磁带已损坏
                3，远站点

电子传送/电子跳跃/电子保险箱/电子链接（Electronic Vaulting）
        通过网络定期远程传送批量备份数据
        Electronic Vaulting 阶段性传送，不是实时的。


04，可信恢复
    确保故障和操作中断不会破坏系统安全运行所需的机制和规则。

04，可信恢复的类型
    1，系统重启
        以受控的方式关闭系统，重新引导前不一致的数据已经得到纠正，数据结构实际上处于一致状态。

    2，紧急系统重启动
        以非授权的方式关闭系统，重新引导前数据仍然处于不一致的状态，重启进入维护状态自动执行恢复，将系统进入到一致状态。

    3，系统冷启动
        自动化恢复机制无法将系统恢复到一致状态，由管理员人工介入将系统从维护模式恢复到一致状态。


05，可信路径
    为特权用户功能提供可信接口

    提供确保使用该路径的通信不会被拦截或破坏的方法

06，QoS Quality of Service
    QoS 需要考虑的点    
        宽带
        延迟时间
        抖动
        数据包丢失
        干扰

07，恢复站点策略
    
    1，Dual Data Center 双数据中心、冗余站点、镜像站点、立即恢复
            不能接受宕机影响的组织可以使用此策略
            优点：停机时间非常短（分钟级、秒级）
            缺点：费用高
    
    2，hot site 热站，缺少实时的数据
            优势：
                允许测试恢复策略
                站点可以在数小时内恢复（需要导入数据）

            缺点：外部热站存在软硬件兼容问题
    
    3，warm site 温站 缺部分设备
            部分配置，有一些设备

            天级别的恢复
    
    4，cold site 冷站 空壳子
            冷战就是一个空壳子，空的数据中心，没有任何技术设施。

            优势：成本低

            劣势：
                恢复时间长
                没有前期的测试工作

            周级别的恢复时间
    
    5，mobel site 移动站点
            在内部配置适当电信装置和 IT 设备的可移动拖车或标准的集装箱。
            可以被机动拖放和安置在所需的备用场所，提供关键的应用服务，如电话交换功能等。

互惠协议（Reciprocal agreements）：
        组织间用来分享宕机风险。
        在灾难发生时，每个组织承诺分摊彼此的数据和处理能力。

        存在的问题：
                1，组织需要预留一定的处理能力
                2，需要组织遵守协议
                3，行业内和竞争对手很难找到合作者


08，测试频率
    BCP、DRP 每年至少进行一次。
    当发生重大变更是，也应该进行测试。

    测试不能危害正常的业务。

    
09，DRP/BCP 的测试方法

    1，桌面演练/结构化穿行演练测试
            作为计划初始测试的工具

            目标：
                确保来自所有领域的关键人物熟悉 BCP/DRP.
                确保计划反应组织从灾难恢复过来的能力。

            特点：
                会议室演练，成本低。
                role-play

    2，模拟演练/排演演练：模拟演练的特点是模拟一个真实的灾难场景。
            比桌面演习包含更多的内容。

            参加者选择具体的事件场景用于在 BCP 中。
    
    3，并行测试 Parallel test
            备用站点的运行结果和主站点的运行结果进行对比。

    4，完全中断/全面测试 Full-interruption test 
            切换到备用站点运行
            风险比较高。
            

10，保障可用性
        平均故障间隔时间 MTBF
                设备或系统平均可用的时间间隔 uptime。
        
        平均修复时间 MTTR
                修复一台设备将其重新投入生产预计需要的时间 downtime

        平均事故间隔时间 MTBSI
                MTBSI = MTTR + MTBF














